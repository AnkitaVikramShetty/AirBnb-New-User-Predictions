function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 16-Apr-2017 03:06:06.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx144 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx12 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 112 113 114 115 116 117 118 119 120 121 122 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 143 144];
x1_step2.xoffset = [-1;2010;1;1;2009;1;1;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step2.gain = [0.0198019801980198;0.5;0.181818181818182;0.0666666666666667;0.4;0.181818181818182;0.0666666666666667;2;2;2;2;2;2;2;0.08;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];
x1_step2.ymin = -1;

% Layer 1
b1 = [-1.42266668658411;-1.0993317510079212;0.81965808843428489;0.50220420081500416;0.1382110787813671;0.19146911161213867;0.50051188415101577;0.79271325942136395;-1.0769248691779174;1.4304208152785343];
IW1_1 = [0.67310174663313782 -0.20393582121680062 -0.070151839186896547 0.10181911485059914 -0.1710556593525612 -0.06157937255990116 -0.094267521132506901 0.62959314197091276 -0.55025120549139062 -0.5425852157591351 -0.038601209840443462 0.089987790199152873 -0.080870371067987903 0.17903696794208634 0.091384405847967629 -0.0060478676426752561 0.12839480370194598 -0.02374387265659841 -0.05221600341685495 0.038617626006764473 -0.13372371352848716 0.10537286378355523 0.17290309670350934 0.1498960064229842 -0.00090774166161236656 0.15527122950579192 -0.18770372879104699 0.19056481950619913 0.097813456742278482 -0.17645540686736697 -0.03398143848140156 0.10943075165757847 0.1505219459587723 -0.12897725246932021 0.0032657882222369449 0.090939782323788937 0.031713081387327528 -0.040313897038372869 -0.16784001884648997 0.014551958234215047 0.032751990658034517 0.14697726420416041 0.030691241182065645 0.0018460920832043732 0.049606156262019883 -0.061872797562880132 0.022523828649082003 0.021561170869529675 -0.052327230392926721 0.11958538571440205 0.015716142970716947 0.073685122862952257 0.082233830436508434 -0.078941250873052524 0.094319651473941349 -0.17121362031800538 0.13004227839452767 -0.015678878504179754 -0.12436382678415842 0.17851322623976063 0.019918912349485472 -0.13961562347795486 -0.069306317748524346 -0.16229627133961919 0.13308114804963209 0.17464473460454508 0.019679326824028846 -0.10943126094148815 -0.17667991025579122 0.07527781516084435 -0.055252274406112814 0.14213201111377061 -0.095237265120099113 -0.11948787014308007 -0.0026392259981348498 0.03175131924505066 0.004762655877907601 0.26676998019811154 -0.098209345479094726 -0.013680710144754644 -2.4319498018815066e-05 -0.087717414249419742 -0.090096673813718928 -0.14232372758318926 0.052735973829625339 -0.12420548640847866 -0.11813070060665098 0.15705646961083772 -0.029643221006248659 -0.11310367235043306 0.083713668731705701 0.15478696845022913 -0.15493231240532274 0.059007899373644056 -0.17766495908801919 0.076697962982692811 0.10926255176475166 -0.02613796688867432 -0.17109392153185785 0.1640120718783146 -0.022035273730642114 0.17901642542262935 -0.1296582185174901 0.19736303261318111 0.077986640335913349 -0.06377943950955238 -0.199884554306797 0.073795075982080752 -0.16347035688799882 -0.067157222339050165 0.11502960340050913 -0.06960076173401937 0.031508291927187064 0.19173707772370277 0.076164038917293259 -0.085069682620334458 0.070990242540312817 -0.057088785032179901 -0.094536990496679324 -0.18474337676664962 -0.095460815587453202 0.19324298495907227 -0.079219839626457247 -0.081516221871361288 0.090932803039822999 -0.051764024397549208 0.17404252229343969 -0.096065082037172317 0.13052167643961102 -0.090940094268389227 -0.012207908144906778 -0.085255937328130291 0.18482987651996563 -0.20185832108564639 0.0057686928965219163 0.044421102127966607 0.13240439436281445 0.013535144757215845 -0.048761195856022746;0.14440435568830245 -0.058860672263179301 0.13212215348403 -0.12086922807784584 0.093419613868558432 0.16646008362139811 0.0035652031348998871 0.20037731447345214 0.00051763029991760891 -0.012382854058203061 -0.002053541354256555 0.27483537867330682 -0.1236039905989912 -0.21795851170716521 -0.078938338221308302 -0.035336041272389609 0.0073475263418153625 -0.12491333077863895 -0.14199382029352309 0.082812202794185982 -0.20213942756032635 -0.12159423086496748 0.12219429812500329 0.092001421989596113 -0.016526878722522842 -0.21226295251801988 -0.19388586050591644 0.057030225586409911 0.090689280835747399 0.21012039222711495 0.11990368714868332 0.019275039855230058 0.064683608120199951 -0.040247778545524242 -0.11345467340000558 -0.1160658286856165 -0.020861643913934077 0.12955251256899125 -0.10868446727041391 0.21484708458028653 0.15001762201407787 -0.054115929239077459 -0.108885148639685 0.044569876782736703 0.15221810429167662 -0.10743556116705605 -0.11936924269023479 -0.0077337311877489845 0.10618094946460073 -0.0087025740474348558 -0.064978962046561298 0.080815167237869023 -0.011870140561383026 0.066050224005254884 -0.15390818738169967 -0.16603626460780305 -0.077026270521246512 -0.018629897919459328 0.054273521982931054 0.02592798948617436 0.13546778012259372 0.082801008267377643 0.15164864805318828 -0.16349849943792191 0.16500917491036787 -0.094022175243493974 -0.025820635457680065 0.13668778712139038 0.0007783794495058369 0.096362421850153812 -0.23333622867764023 -0.082021330945376184 0.16313470196791038 0.12980267201661805 -0.19306160590553301 0.19105718317426218 -0.15332684497756424 0.11445205342938983 -0.18652949932688473 -0.18381993405114982 0.038188435453305108 -0.12387794212016838 0.097959767594130331 -0.014678651840979268 -0.12657912613795419 -0.19251175661508807 -0.016515925993111351 0.1716956725456549 -0.026105042726684059 -0.08893086852377953 -0.1788035574745826 -0.00077964171301427747 0.0031418210400026908 0.17812753746924145 0.10865650587962992 0.27255056178332043 -0.12606923750532989 0.14394464415547775 0.05290862206357478 0.12261248210098062 -0.12593980871595395 -0.2166024899083191 -0.20660388789231784 0.10806456983161075 0.086406863455299868 0.15990378764134686 0.14120535197618309 -0.017428708209703436 -0.012192595992586302 -0.13313081832515697 0.059572972648106064 0.18075910369088011 0.20104077254539679 -0.082485356765369972 0.046716315834895016 0.093257726997459087 -0.084938554175377948 0.044597281526255576 -0.11281590671820575 -0.076323241985426032 0.089331873362074266 0.085731741441552281 -0.16457926079733573 0.18296676675495901 0.025677844629824111 0.032753546618869686 0.1271605204039058 0.11553900465129503 -0.057739721314099733 0.16373131090639434 0.087523725464281832 -0.11820526833445991 0.089014254969477569 0.0081665860596812703 -0.081184520393383502 0.13083209092790318 0.0067162627200349411 0.017401628058710664 0.11171199142719097;-0.15730169191621846 -0.13279533608363109 0.1560373306158408 0.179821636295418 0.20429105696349303 0.17422971865416859 -0.14250624242787532 -0.14251780353805452 0.10355655603165173 -0.15220878283272279 -0.070444238882731422 -0.0080527311909757513 -0.16640113481354576 -0.22147102438692703 0.069568884557678734 -0.051341906825882327 -0.091799695826315822 0.11640814151215186 0.14206675050713405 -0.14608439387572703 0.19502748578070447 -0.031952329166098054 -0.19827654008274881 0.062010347490667583 0.14192621797205812 -0.033091264954396293 -0.019479188389566044 0.097865249131109763 -0.21201759322912264 -0.16866151452249151 -0.12441203008000482 0.054434652322117069 -0.15948605354716275 -0.036351275859430106 0.10854371182362368 0.012019916020514628 0.054024404220226238 0.063343958973243478 -0.17487944518451426 -0.13290737258489699 -0.082137756729911651 -0.038726299846876588 -0.079155426899100087 -0.19450835894941518 -0.1511692274944206 0.039827857027754737 -0.094968788736797288 -0.016010835627087661 0.025223743750152003 0.12345443281973116 -0.21998855480330323 -0.053238640485050837 0.10184824944376127 -0.054633023056618303 -0.15182749080973076 0.046880153897940785 0.020520733651967406 0.099187589380073937 -0.20381411687848305 -0.23223495548808284 -0.071024861113341151 -0.12010932048418944 -0.12446435030961264 -0.16964090010801022 0.17571096273407211 -0.11509796739850441 -0.2122195728300211 -0.098443005502844183 -0.09780437932754231 -0.0023450651812643823 -0.034044700026865805 -0.11407087202488375 0.14463321344231853 0.024650163828240878 0.092505101173609175 0.081210626311950626 -0.17482922868233999 0.15391167928049918 0.087009612754196816 -0.11453826734955332 0.16706378073086875 0.09783944344774817 -0.19780608952327439 0.061246941535588434 -0.098128550278963292 0.14584551996847053 -0.17524446869086879 0.14067362007277021 -0.060843810341483298 0.035977775945244303 0.047741463083721056 0.056661379050359194 -0.10237272708035867 -0.17084927852444431 0.043357232304288985 -0.0099162260633383487 0.036336472699044567 0.069971655520155579 -0.16366484712686535 0.074874899738870057 0.09960348297421423 0.048700801594499625 -0.19477778492258047 -0.097809360368274631 -0.0036635201174167703 -0.04800645545129946 0.14935645830647079 0.023328780495760579 -0.1583515647319006 -0.02460488379974729 -0.024566752400097109 -0.18717756157496598 -0.008110030877052107 0.11368222804103392 0.0094790259429485563 -0.18175989550984176 -0.03747653052474726 0.10243590859388445 -0.099935078668571861 0.070702133783192123 0.064902713773523732 0.11417314182316478 -0.039192447836092624 0.17407492734307795 -0.22894630903048754 0.12834652301341459 -0.03540872508071416 0.13268686669911894 0.13168940787999656 0.10896557768126118 0.13339967126116731 -0.095154823556255583 -0.071061822680475284 -0.19941422313696777 -0.05843343599850126 0.13412335589719185 -0.15467218649601541 -0.17384304456288882 0.070038034807990771;-0.014202897200086025 0.024715730951199364 0.19234859531646339 -0.066117206178052015 -0.065255379734117533 -0.16036876528194746 0.041264076730072555 0.11510609036548369 0.13660148694491578 -0.13942824514764343 -0.20752914236977679 -0.0085692379804965541 -0.15310925329125355 -0.16807904029364695 -0.14201814912055977 -0.11015044009783644 0.15908844529878946 -0.15719624330607349 0.17693851693773194 -0.19055545317830222 0.11627343966505814 0.026175627210251028 -0.12900462319492267 0.14382280706330053 0.019004428820138513 -0.16894551125193707 -0.19943688751671584 -0.047399679598201655 -0.071725059227832594 -0.1947200883105292 -0.05709326861960954 0.043214623720218288 -0.083661934180963002 -0.18898495797551129 0.17776118503121277 -0.23035112216184367 0.057462731347418132 0.17163343327802882 -0.12088711466302297 0.050792298834397703 0.10519782165300386 0.086754339608485762 0.044275683727855862 0.002924298015708442 0.061463932322473429 -0.05954271498154852 -0.1755457379326158 0.1818761470705817 0.088368418236415322 -0.030670599888723473 0.077391937626997878 -0.23216357053679709 -0.045344711606756523 0.11422434635423068 -0.068050974775501982 -0.030621303391883951 0.11697494987604204 -0.14319531530968432 0.025742071114758028 -0.18826329699316158 -0.20484472244846619 -0.011580517181639726 -0.14763911409302011 0.023717858278945708 0.12509662691391552 -0.098861634035553619 -0.17515890108139345 -0.058620368178945857 -0.16560413170675689 -0.16143435272146342 -0.21282689518758277 -0.2132920535696067 -0.014252795476061278 0.020617989458788649 -0.089941388142261339 -0.1978204269005753 0.032234218657443511 -0.17615799018179754 -0.15263355736026044 -0.1373401639287305 -0.056052609757658599 -0.032579021866372293 -0.085629938901965838 -0.0015329972719196638 -0.1081092188164631 0.060190912472226688 0.071589162928937591 -0.074553459491214627 -0.085640884963666258 0.16652130721123207 -0.04333271423413123 -0.1751430248235088 -0.0079339701235454328 0.151385223562641 0.063835239653481285 0.053748595826811352 0.015949034355142055 0.0027262327192624121 -0.22133203577111007 0.10548653299652447 0.17909498597627602 0.092958016931983981 0.021804345663270337 0.041351239201641576 0.015655277605459848 -0.064581177796159059 0.087548417182009938 -0.13982731601315276 0.14070968349201787 0.14512124350451377 0.14383039507017925 0.070351317903619176 -0.099878921326845699 0.074068707557530575 0.040607696056243994 0.11552219140876312 0.17127928588647923 -0.23231138824238767 -0.17571433329614308 0.097643457727097274 0.13328008348992534 -0.056143323741260603 -0.086271625872720248 -0.11853620629816636 -0.050501025381783311 0.15672814703861215 0.081502048969520222 0.14816830007943443 -0.11896755268524438 -0.074540233322361621 0.066097735025488963 -0.080537431350755084 0.1134693835172169 -0.17801719317501882 -0.031226220473937708 0.15571186527215899 -0.047344229908936858 -0.0012745321463637886 -0.057447896103115556;0.019347350485413389 0.13678539732715317 0.035176112583598776 -0.092656349653766221 0.053678675689291237 0.046594715626721843 -0.061065889207661567 0.010527126937646174 -0.10115035853475993 0.10476528246603871 -0.099553402499288679 -0.10284077326830844 0.23416848278903626 0.089120063837132238 -0.089176194279686372 0.02372310584333346 0.19582134812853438 -0.10830501286408184 -0.0090637701408993465 -0.075535827913683296 -0.036967327780782912 0.10887724270658058 -0.057386523280263141 0.23087403298578205 0.074931419161061441 0.24372562598495087 0.16684777973114459 -0.012067363514953982 0.029703344073210177 -0.041218402083834184 0.043410236089124733 -0.12921280941797181 0.001113395006575997 0.063456935806253958 0.12336080980164289 -0.018830814619211791 0.082822700398926294 0.034064613556482382 -0.0093374683410588754 -0.084232519362004293 0.06237211879129035 -0.060881826081962048 -0.10694040710338967 0.077735887652464031 -0.096016082525920809 0.082048801450302924 0.32471057645553036 -0.11214435985451918 0.22379480212774674 -0.017315007278565404 -0.10991982952716653 -0.059131579696249631 0.18135090481217347 0.14535420153113018 0.13511823243033599 -0.12573753565787193 0.19627907004054199 0.018790026414073038 0.095128012229655542 0.19081247262901846 -0.034870023878448807 0.10301854284811165 0.049060108090172222 0.054386754730836678 0.15337505326255199 0.0043621746234892471 0.097103196929845578 0.013751155030936589 -0.11592777911155111 0.065256421982570756 0.15954854323950887 -0.071830115078935372 -0.16650622651235425 0.1233504509914215 0.041839003548544348 -0.20569378325314469 -0.084328081002790073 -0.0036521580020241395 -0.046950534402321879 0.040699495566138395 0.11057115007188993 0.17915219039981775 0.11871354448459949 -0.15098761676573633 -0.11795678637550194 0.04538396402589024 -0.066078019141285804 0.072312938091133316 0.044308374839797972 0.21880135644134749 -0.11478933938675076 0.23186766196691905 -0.02732806154576755 0.15783681259714274 0.086176652334691212 0.096220932958653138 -0.041595123932695294 -0.13032027919550915 0.12421869561062747 -0.034622802007541482 -0.1997935881090287 0.035745953139009676 0.2254853619539828 -0.099660577643672907 0.039283736685964486 -0.11202079144441833 -0.19387183937658262 -0.13097020802603065 -0.16748665062647369 0.079345938693202403 -0.10784243960659493 0.088078366306743455 0.075824080513631792 0.23372103827550761 -0.19217453772170612 -0.14927012216938207 -0.16127367441148169 -0.17462815949521984 -0.051208091843228949 0.040933447585039383 0.05889631176401109 0.0061839962611767701 0.1545098743419826 0.16057698669670725 0.087568854996419351 0.098713607433526265 -0.018840025175287531 0.047292122465863923 0.15892166332354232 0.018950832697512209 -0.20579306756127388 0.04230558921203257 -0.15102102191696484 0.08150379262429347 -0.18063957063955843 -0.12462267706653575 -0.013758896714247036 0.1111076486799332 0.11046231199635033;0.047953830238033852 -0.059969845927146194 -0.15108439264906423 -0.10715871853148906 0.12024224389272704 -0.010999920322566631 0.063528728427018344 0.18874779191177252 -0.039536881458509525 0.018408564238201041 -0.19234280360935099 0.18953325039390592 0.17306217378337432 0.06488249451530631 0.026469953144786468 -0.028748419413750597 -0.012105718272833337 -0.1727448049965033 -0.19808798386732174 -0.11012050322314136 0.066061298077090103 -0.07724858534202507 0.042827659888739406 -0.10300064790421007 0.11892760704519661 0.056766451947927538 0.10117461230756014 0.10447716083049238 -0.068866412459612281 -0.16084727754015299 0.15407046785114661 -0.19106157415550529 0.17068450337544641 -0.14933221052575979 -0.099708812586429357 -0.11257555175230598 -0.23045987412055186 -0.10744260110721106 -0.021863479819618319 0.03944256289357418 -0.24352875747308766 0.086763405676909447 0.10898004469951125 -0.0056378791870378394 -0.19417233217868815 0.11703730231812554 0.03411223494875941 -0.19656995968088642 0.16691849895353325 0.040277925549571394 -0.053723365005680118 -0.065374569784386966 0.11594314707171562 -0.17421160874005814 0.10490019982562503 -0.035301778837201286 0.19036587038986774 0.13634671169176102 0.063986631699440147 -0.039986125968298411 -0.16051696714245262 -0.033315996952122111 0.02611823879225814 -0.22304429165631823 -0.027540866468966092 0.029454194551516849 -0.1059999169586535 0.087612579121649603 0.13824555443765346 -0.11794861785654449 -0.14524902918458119 -0.22507661705077114 0.10768023344356037 0.093012801971230422 0.069334084826229839 -0.20426423488171483 0.032251404391771571 -0.026302741833488789 -0.01079149866190483 -0.20642325094022723 0.076500758093102486 -0.073232328496564816 0.056761755812780118 0.063257792206487751 -0.13894458301898754 -0.11233063738586324 0.18522353108019757 -0.11433291978506221 0.069765212984135697 -0.051254712140548421 -0.20333255441382031 -0.015998792976283181 -0.069281825473495068 -0.00056137437187585846 -0.06757646812693538 -0.035609119613854233 -0.18424538639529439 0.16041988101054122 -0.097932482163766765 0.016358376264132318 -0.018209628352767127 0.12990905086613552 -0.094961682708835274 -0.1199297759373522 -0.19325460034809594 -0.19187242118398365 -0.084910743343839218 0.10630498690153257 -0.22638782882993363 -0.20208147296011444 -0.077477820134685113 0.10779953502342561 -0.092344891263693676 -0.23158059105459378 -0.097371234195529038 0.0040763610448435418 0.17109084233110802 0.16779127453738926 -0.19356007317965443 0.045560179354663465 -0.21511121893762616 -0.0076003835362271378 0.085405154544330411 0.1344608231536937 -0.024331187092845392 -0.15753053227591182 0.16651311066055602 0.0085757485826866726 0.050912757649100263 0.049194713976515196 0.040736713411876957 -0.00709635572885814 -0.21948155825976109 0.11886915065149087 0.13091623995929663 -0.13558272245204925 0.16409765593819789 -0.064441390572840956 0.15525451737790416;0.041139081161035082 0.050803335283180304 -0.14261307543342594 0.047523720595631785 -0.036556836835831927 -0.20278903213322558 0.07955289930643146 -0.12277220207926297 -0.15867557022730044 -0.012940891129441504 -0.16469255653826162 -0.03276871114408484 0.0083487783923133045 0.038797003815052973 0.10026732943783573 0.11323117919532472 0.027667102661009173 -0.14537249105874131 -0.13193156867603759 -0.059240828634697831 -0.090482410909872912 -0.085025085840509648 -0.18560184008365721 0.061079731489157775 0.10790243432995392 -0.025824377434286113 0.071546606293958176 -0.20879246717974093 0.043078410794057442 -0.030535027187831607 -0.062727568630874211 0.19279085056602524 -0.17669075811980264 -0.07664328284724177 0.011294287284583777 -0.17361943941399985 -0.21462745651479473 -0.1989043037144447 -0.044807035174581497 0.059942876789014686 0.019518746769389892 -0.028170219618438633 -0.14179307203019861 -0.056570430231773945 0.022748426018032432 -0.11251285158207705 -0.014924243779525153 -0.19756052904983126 -0.16113646587102526 0.080003700296416624 0.056658060921670216 -0.12677956381216868 -0.082070853846312575 0.13278440592283167 0.10141540168023704 -0.17885980161697387 -0.19684630346503054 0.0076525794005680029 0.14580251938060268 0.1251938162818676 -0.19125728171959619 -0.010627311511778344 -0.060811219222630573 0.16304542702423608 -0.16693162278685231 -0.23423510531082883 0.14900097279660995 0.12034355841794288 0.05089665249958341 -0.18600819710573246 -0.16047966879828987 -0.023254191446433602 -0.095846169220905886 0.096240882990389201 -0.19673601004513766 0.10705718103792623 0.084480884078085516 0.10100332060025601 -0.14311662244178208 -0.067204918137670225 -0.055876750192299332 -0.1142546946814452 -0.18578001159403018 -0.17785384096810294 0.14810823235931356 -0.1722584878067871 -0.048583057191294743 -0.0067254709439202162 -0.059511474897418058 -0.13905812004689178 0.11582389895928977 0.052766137826006324 -0.16601775440147512 -0.052335042037716085 -0.074054913031052452 -0.21755984742664372 -0.23242471475752355 -0.12905419351688269 0.044385525190599094 0.0070574923036711701 -0.20707753545119803 0.14889057631913794 -0.065236679677641449 0.052952247149960378 0.069416528311986372 -0.10982693904173634 0.063550541162268728 0.090984771411787235 -0.00092609495103476757 -0.0738974900414609 0.16571268593551466 -0.070560360475139999 0.086418819501023023 -0.088812749223683457 -0.047292009057633207 -0.08473210154321717 -0.15021190933187936 0.040319801341967047 0.14238490291725756 0.14655941976608794 0.15922986987326285 -0.12727216992861173 0.047840960753445592 0.016712021097149331 -0.082053819544070802 0.041406689129349541 0.18791212367234991 -0.18010865510523663 -0.16457417167503394 0.1205678524006083 -0.05300447040935069 -0.071694916013512647 -0.20835805113822664 0.18188946023475375 -0.2169624930810265 0.14840217517717186 0.026579467673877803 0.12137128691241335 0.098590215483839297;-0.14402194691307488 0.0057231972814761316 0.02681038560973505 -0.05556332820895199 0.11708619286419841 0.065723947264317586 0.053238755262313864 0.2674344253294596 -0.14225749126500145 -0.13013671257774692 -0.15476444274565351 -0.34633761262080109 0.038059633580400681 -0.06117062680038849 -0.20534267517626514 0.12057474712853096 0.034385686088376992 -0.023672769076664532 -0.069851753026694177 0.015073544795491469 -0.2104659168735607 0.057425296298153364 0.081858030412644972 -0.12245986175329686 0.031123199060575559 -0.009618919131545613 -0.134622343054596 -0.15728959594116851 0.1245464392030458 -0.085252886015780446 0.10335378974947462 -0.1546200059818798 0.14254989119469993 0.038578448129478596 -0.060768158704415126 -0.035954994867780907 -0.052896078142893842 0.056415503226102247 0.15798704000751068 -0.036977049653940101 -0.082453472877536349 0.18365340956045317 0.016033456611195693 0.087158256593320799 -0.015861281300548809 -0.11471005851013222 -0.049683234109540286 -0.14005250187621895 -0.15985598132704884 -0.019425412017272058 -0.12338336650177607 -0.12873467179678558 -0.18669765587522133 0.19695532893011128 -0.033070309172797151 -0.049780264731964952 -0.062763954178422857 0.1985813574216812 0.21281211173570164 -0.12029221362047583 -0.13716505633731504 -0.078179982611801285 -8.1873905087357214e-05 0.095756063798233537 0.02078094101945106 0.14381843424273416 0.10664941703748311 -0.15695406660313488 -0.014869074520771776 -0.12642101593746516 -0.10881012526572914 0.0038142003895259434 -0.099576189440670704 -0.22227971990737699 -0.073407240205965174 0.1353092345932006 0.028687543195151575 0.011000838096272213 0.15685317143024863 -0.11301498634668701 -0.062514321896301711 -0.20193084527391877 -0.1087203948056616 -0.19591616296667405 0.17228465732123432 0.07942916813732441 -0.095671389270838611 0.20265652463438849 -0.04891554321357177 0.16945228400627241 -0.11813738591934923 -0.1930921064729556 -0.10386253664354178 -0.082101333321574932 0.12399552529457182 -0.011453901855139378 0.095971481171429757 0.13960586643377759 -0.044500572555263726 0.013873727804232521 0.1251045893927297 0.042198091471491443 0.20076850607390062 0.0097105992715777328 -0.0026180509919303124 0.093327046024991075 0.094405669075970186 0.17863639510071225 0.11228713386818001 -0.19209283359382345 0.091577374414839929 0.12102904319520918 -0.040014073808203883 0.062399934813515398 -0.097458698923723441 0.12517412861624838 0.13489400647700153 -0.10964662346820235 -0.17297044037547504 -0.18580057013282431 0.087276598065194638 0.10393905839743946 -0.15145365273464576 0.15877673509679566 0.18246096734179845 -0.18455356090824712 0.15241149607441346 0.14391143954781846 0.088466011100750253 0.048305521265684451 0.0077041721580942014 -0.0367162896337394 -0.14406459861570167 0.030520479421338228 -0.030801120424801449 0.041936922330700503 0.072754574918312068 0.088762743669580618 0.088606867318407376;1.9214974699260789 0.03592793414035373 0.11312122327428854 -0.031056859408145659 -0.23410701844119478 -0.1728081259062029 0.013994268092387326 -0.17113245817338055 0.036485237896107296 0.048589004391442113 -0.056204708861892452 -0.049958949811566983 -0.0092741998136485933 0.055614769593096823 0.046619692946677074 0.030138137368868972 -0.15152150328026082 -0.11458654220710147 -0.016449452076134061 -0.21878896256100142 0.015630741107182045 -0.17509051779348639 -0.18558090352109283 -0.18418319788521392 -0.1670931351360741 -0.21376147865454295 0.020995652067224382 -0.16806587072754262 -0.20820733533820202 0.16929923379442124 0.15547498048550237 -0.18084606057607969 0.026529347962205473 -0.15954691280378336 0.067241444050609209 -0.11042393382957344 -0.011409933546130603 0.08421786466361357 -0.032329242106457719 -0.058642352807261031 0.049926269983138219 -0.3889484392096797 -0.0058029283080791019 0.08985116227263569 -0.069225405745141522 0.093363429293151556 0.010971964910875995 0.038444899415943527 0.050138359860857205 -0.0019604994862933776 0.11750014242047953 0.10744196986445641 0.068162476454735763 -0.028910906454155318 -0.0052629470268819954 0.053565769686781409 0.02979504052019244 0.017406031761225717 -0.046115016340927066 -0.0084957282664634547 0.033009706295872687 -0.074867239401892702 -0.011885248595736923 0.065241333319501382 -0.14832418963295876 -0.008868634618240747 0.085114772413442882 0.041525434311005825 0.13746550429682833 0.10547197040811068 0.034294079597571296 -0.02595775132852246 0.026489577636211049 0.05602675609984923 -0.017971961549169496 -0.0049743933041893479 0.10518650485206101 0.18362746939908348 -0.014840724376144077 -0.20826540855014403 -0.10001412762622987 -0.087781468098334592 -0.096464398181529257 -0.17961139114127272 -0.072458323211955472 0.16968914728825313 -0.14787745516888903 -0.12027073200011409 -0.088170718599704906 0.034864366462546231 -0.18145941384161629 0.099657844109715593 -0.23563125276944996 0.072802845622168252 -0.09964245485485744 -0.019552833068621094 -0.14201394593363809 -0.10417152388418038 0.014579744777118181 -0.1289593169944343 0.17760144836373781 -0.18249219196037908 0.1604136919713692 -0.067961866232645649 0.0056996223610616438 0.08925915838810429 -0.14894987210145844 -0.19199799640893697 -0.11125002634161749 -0.025220168734808143 -0.0011159881166325155 0.10885517882756217 -0.02896931429641918 -0.12310134986269487 0.062064122544604867 -0.024537049281430818 -0.086749716990794479 -0.074232745738510519 0.15397506207074965 -0.11737900916682506 -0.098074078295416395 -0.030173419100298252 -0.23673414392160416 0.15962348799032114 0.10652651030617337 -0.069593211172912034 -0.077976781527684225 -0.041505989859770914 0.026668668856331013 -0.003620903396800663 -0.16654141802355638 -0.031283157300661855 -0.10156806724691371 0.16769164287058633 0.10986697860592379 -0.030895041152240465 0.064070076828764172 -0.080843100729583756 -0.20326808445721822;0.070495155564604214 -0.10126067457766512 -0.1078923780067693 0.14422615730768493 -0.18809712567905409 0.1264235656390266 -0.17982800132594781 0.19895839253036648 0.17107679452794508 0.054720042138567758 -0.20275645420003316 -0.054209798391158956 -0.057333108531440406 -0.095357673786469005 0.12217297602087311 -0.059687063931356546 -0.093209540201111357 0.17660395455294656 -0.10973230243894783 -0.10994943975812328 0.024572223994492683 0.16007863357057925 0.059654612790978584 0.099057884413996017 -0.11983916373668187 0.071908983598697074 0.0010918229934599951 -0.05434343319527684 -0.036153351860680367 0.17528673328037497 0.080169330001724756 0.019511294990484304 -0.060747316815290761 -0.097955618629855024 0.15780871906772226 -0.18257229649297715 0.059998750804427438 -0.040189147758091633 0.18542552475205021 -0.12612739826624814 -0.20987581278435696 0.091332240387353214 0.10749693558625112 0.074251118792489038 0.063181881101242912 0.0089500361979787495 0.056458755601739921 -0.031973479294820153 -0.18334412978380724 -0.15973519668030556 -0.051216852763796811 -0.037432795671482388 0.18762716321715081 0.15963565395214768 -0.18732614836979219 0.019729560767786918 0.20479484685928653 0.030633370774511372 0.028574915818444686 0.049277553571764741 -0.12693713844562371 -0.011017903470635308 -0.18797562252908334 -0.19638773347204269 -0.21025299580481568 0.14658297731995876 0.01496585084208361 -0.06415819976471078 -0.17870377689500561 -0.19283499071796317 -0.18012906316275787 -0.18520853047476782 -0.21754530532721297 0.021740758811014421 -0.0099676427292625675 -0.15900715320019998 -0.11719678902980003 -0.066316412149365539 -0.15674420534006261 0.11627230810900181 0.18118109747964412 -0.037637717004790981 -0.21442319051184422 -0.16415920874422618 -0.13633623352555579 -0.14986599580558166 -0.05763752148797107 -0.066439736807566568 -0.2126801691012549 0.097339026331229719 0.064989253401699892 0.1008026455390654 0.17673428376907571 -0.12463612090323753 0.12939376634608354 -0.071315653813223592 0.091281190199288625 -0.061890010070319058 -0.21451375243680132 -0.1160662476944388 -0.19487242570348745 -0.1294418024169032 0.06958359527410575 0.037483241185712307 0.19777947631752393 0.077019956698124642 -0.10720804727092348 -0.14488088865781842 -0.14627049902155589 -0.03665279748334882 0.044270553568052498 -0.084008981454085779 0.077433915541568379 -0.12398501605940442 0.14748068269514825 -0.011498042922520943 0.070759304916100565 -0.17097587154996524 -0.050836165834586423 -0.20384771070061566 0.011889600576489804 0.056643968397685263 0.018922970963053849 0.014286197032127733 0.14438246334594737 0.065369016054867154 -0.026665574068210542 -0.13475625298805527 0.086899153434931736 -0.082486428972787837 0.12950610060378515 0.061297274148255844 -0.093037385368890779 0.016192164923520099 -0.05278237740233277 0.041893960062585549 -0.073453224527246203 -0.026907594148899882 -0.054748327060529137];

% Layer 2
b2 = [0.73655287022756111;0.69886556282746704;0.12010713450525566;-0.28092128993597054;0.49558631691877952;-0.13812358467180508;0.7687984185253347;-0.65060948948282238;-0.11525809596864668;0.39813064844924734;-0.68562320461433923;0.13492318479367624];
LW2_1 = [0.22357724405309604 -0.67776147216103588 -0.88655699129775889 -0.53442549214958379 0.95607133434264047 -0.85173957028037728 -0.56720548389654779 -0.97783441072542621 0.0089370143427681143 0.3281138740276992;0.086001232929104471 0.44167052615894259 0.70039627594662457 -0.90145650702450097 0.41722201244667884 -0.21770174735911887 -0.51818851799678778 -0.70720908788524683 -0.41928494467163591 0.17167244622419386;-0.76372266904609643 0.25342923343484536 -0.8454042017222807 -0.04382533792193298 -0.023227294677274333 -0.45799665908019338 -0.21110158915123184 -0.7760855042193473 -0.68874342174299685 0.041836594554233844;-0.40718527280977901 -0.91117870516791366 0.088748499089185279 0.22919847848388189 0.58470278117760033 -0.13996696779244286 -0.70599814130218674 -0.36546427492310984 0.0023256688214667019 -0.50920642801786653;0.68055242669748006 -0.6939494845601768 -0.91377720216067959 0.33526449573760986 0.27715600405197566 0.47214912873643589 -0.21362382192803497 -0.84756085559770211 -0.29497440227355015 0.3357120162737311;-0.63575587948623213 -0.65782884502203365 0.099380324582573773 -0.84483730956823844 0.11079434813044474 -0.20564294319667178 0.39183673614694725 -0.72597022231397224 -0.64296355112619719 -0.56583188405820395;0.55613049691273142 -0.92819252168511335 -1.0231375492992789 0.30457617043643592 0.3576503900377091 -0.24014514908421414 -0.54719994600807964 -0.047644238529189031 0.77741240018257785 -0.29737273205810555;-1.6458768388986547 -0.32954896026347213 0.79862367492381825 0.25235051188098284 -0.46859174842618129 -0.014573940864432535 0.83364835181038788 1.1848786263303499 -1.4042071173787301 1.061247199217916;0.41289270980538911 0.76390370749364456 0.52849138818652508 -0.79304476472647267 -0.35637904491764977 -0.84624715802818562 -1.0164797249483257 0.4674607054325105 0.83878635960265324 0.53341530048252195;0.072586372108841571 0.23030271983283213 0.8007742112577021 0.84863791267824473 0.24059777259496928 -0.49489413097032164 -0.23817069386466941 -0.15030867331925046 0.33004410511375071 -0.23082286886415801;-0.52923404790586015 0.079089491129587561 0.93079267499965068 0.1404812370016435 0.77902910822843696 -0.86592007085378353 -1.0350780542787288 -0.11006399735478029 -0.95470633340141076 -0.40799679991604099;0.10961314461890795 0.322397595634482 0.44603622335753301 0.26863817605408685 -0.64478606747894662 0.18717377247373496 -0.13030818510310205 -0.076654947368575616 1.0272386757209109 0.67753567820067528];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
